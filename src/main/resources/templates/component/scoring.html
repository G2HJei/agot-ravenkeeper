<div id="scoringModalContainer"></div>

<script th:inline="javascript">
    const SCORING_MODAL = `
    <div class="modal modal-lg fade show" id="scoringModal" tabindex="-1" aria-labelledby="scoringModalLabel" aria-modal="true" role="dialog" style="display: block;">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="scoringModalLabel">{{game-name}} - Rankings</h1>
                    <button type="button" class="btn-close text-brand" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form method="POST" action="/tournament/{{tour-id}}/stage/{{stage-id}}/game/{{game-id}}/rankings">
                        <input type="hidden" name="gameId" value="{{game-id}}">
                        <div id="profileLinks">

                        <table class="table">
                            <thead>
                                <th scope="col"></th>
                                <th scope="col" style="width: 60%">Player</th>
                                <th scope="col" class="text-center" style="width: 10%">Rank</th>
                                <th scope="col" class="text-center" style="width: 10%">Castles</th>
                                <th scope="col" class="text-center" style="width: 10%">Penalty</th>
                                <th scope="col" class="text-center" style="width: 10%">Score</th>
                            </thead>
                            <tbody>
                                {{scoring-rows}}
                            </tbody>
                        </table>
                        </div>
                        <div class="d-flex justify-content-end align-items-center gap-2 mt-3">
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="gameCompleted" name="completed" {{completed}}>
                                <input type="hidden" name="completed" value="false">
                                <label class="form-check-label" for="gameCompleted">Completed</label>
                            </div>
                            <button type="submit" class="btn btn-outline-secondary ms-auto">Done</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>`;
    const SCORING_PLAYER_ROW = `
    <tr>
        <td><img src="/icons/Stark.png" alt="house icon" style="max-height: 2.25rem"></td>
        <td class="align-middle">Hulk "The Hulkster" Hogan</td>
        <td class="align-middle text-center">1</td>
        <td class="align-middle text-center">3</td>
        <td class="align-middle text-center">2</td>
        <td class="align-middle text-center">12</td>
    </tr>`;

    function updateScoring() {
        const gameElement = getSelectedGameElement();
        const modalHTML = SCORING_MODAL
            .replaceAll("{{game-name}}", gameElement.data("rs-game-name"))
            .replaceAll("{{game-id}}", "todo")
            .replaceAll("{{scoring-rows}}", SCORING_PLAYER_ROW)
            .replaceAll("{{completed}}", gameElement.data("rs-game-completed") ? "checked" : "");

        $("#scoringModalContainer").empty().append(modalHTML);
        $("#scoringModal").modal("show");
    }
</script>